{% extends 'users/base.html' %}
{% load crispy_forms_tags %}

{% block content %}
<div class="container">
    <h2>Submit Payment Request</h2>
    <form method="POST">
        {% csrf_token %}
        {{ form.transaction_type|as_crispy_field }}
        {{ form.client1|as_crispy_field }}
        {{ form.amount|as_crispy_field }}

        <!-- Initially hidden Client2 field -->
        <div class="form-group client2-container" style="display: none;">
            {{ form.client2|as_crispy_field }}
        </div>

        <button type="submit" class="btn btn-primary">Submit Request</button>
        <a href="/" class="btn btn-secondary">Cancel</a>
    </form>
</div>

<script type="text/javascript">
    document.addEventListener('DOMContentLoaded', function () {
        const transactionTypeField = document.querySelector('select[name="transaction_type"]');
        const client2Field = document.querySelector('select[name="client2"]');
        const client2Container = document.querySelector('.client2-container');

        function updateClient2Visibility() {
            if (transactionTypeField.value === 'transfer') {
                client2Container.style.display = 'block';
                client2Field.required = true;  // Make Client2 field required
            } else {
                client2Container.style.display = 'none';
                client2Field.required = false;  // Remove the required attribute when not Transfer
                client2Field.value = '';  // Optionally reset the value
            }
        }

        updateClient2Visibility();
        transactionTypeField.addEventListener('change', updateClient2Visibility);
    });
</script>
{% endblock %}
